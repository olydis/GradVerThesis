\subsection{Optimality Revised}%% optimality
After realizing that optimality of gradual liftings (or “consistent lifting”, as called in AGT \cite{garcia2016abstracting}) is an unnecessary restriction in the verification setting, we focused mainly on soundness of liftings.
Furthermore, we showed that our approach of obtaining a gradual Hoare logic using deterministic liftings does not result in an optimally lifted Hoare logic, even if the deterministic lifting was optimal (see example \ref{cex:opt-det2grad}).
We have also shown that a more expressive gradual syntax can reduce that problem, yet we have not formally proved that relationship.

Furthermore, it is unclear whether optimality/consistency as defined by AGT is even desirable under all circumstances:
\begin{example}{Optimality and Decidability}
    Consider a statement $s$ which is very hard to reason about (for instance, think of 300 Collatz sequence iterations).
    With the static Hoare logic, we assume that
    \begin{displaymath}
    \thoare{}{\phiEq{x}{10000}}{s}{\phiAnd{\ttt{1 <= x}}{\ttt{x <= 4}}}
    \end{displaymath}
    can be verified and that no stronger postcondition could be verified (due to limitations of the verifier).
    However, we know that \ttt{x} will have value 4 afterwards, i.e. the following Hoare triple is valid:
    \begin{displaymath}
    \hoare{\phiEq{x}{10000}}{s}{\phiEq{x}{4}}
    \end{displaymath}
    
    Using gradual verification, we want to overcome the limitations imposed by decidability and be able to deduce 
    \begin{displaymath}
    \gthoare{}{\withqmGen{\phiEq{x}{10000}}}{s}{\withqmGen{\phiEq{x}{4}}}
    \end{displaymath}
    or similar.
    However, an optimal gradual lifting is not able to deduce this fact, since there exists no instantiation of the postcondition for which a corresponding static judgment holds (since $\phiAnd{\ttt{1 <= x}}{\ttt{x <= 4}} \not \in \gamma(\withqmGen{\phiEq{x}{4}})$).
   
    Note that our approach using a deterministic would work in this case:
    \begin{displaymath}
    \dgthoare{}{\withqmGen{\phiEq{x}{10000}}}{s}{\withqmGen{\phiAnd{\ttt{1 <= x}}{\ttt{x <= 4}}}}
    \end{displaymath}
    or a more imprecise postcondition must be deducible due to introduction, strength and monotonicity rules.
    Furthermore $\gphiImplies{\withqmGen{\phiAnd{\ttt{1 <= x}}{\ttt{x <= 4}}}}{\phiEq{x}{4}}$ holds (emitting a runtime check), such that 
    \begin{displaymath}
    \gthoare{}{\withqmGen{\phiEq{x}{10000}}}{s}{\phiEq{x}{4}}
    \end{displaymath}
    is deducible.
\end{example}

\begin{comment}
INTERESTING! Regarding “when does optimal det. lift. imply opt. pred. lift.”
For above example, the gradual formula syntax would have to provide a way of saying that there is NOT MORE knowledge about x hidden in ?.
This way, the gradual implication of x = 4 would (as expected) fail, as the optimal predicate would
\end{comment}

We conjecture that a notion of consistency that relies on \emph{valid} Hoare triples instead of \emph{deducible} Hoare triples (Hoare logic) would solve this problem, yet it is unclear what the implications of this definition would be.
Most importantly, it would severely complicate optimality proofs, as they suddenly rely on dynamic semantics (from which validity of Hoare triples arises) instead of static semantics (Hoare logic).

\subsection{Gradual Non-Termination}%% non-termination
The “plausibility” interpretation of unknown formulas motivated us to define $\gamma(\qm)$ as the set of all \emph{satisfiable} formulas \setFormulaA (see section \ref{sec:gradual-formulas}).
However, this definition implies that $\qm$ may not be usable as a postcondition of non-terminating statements (for which proving $\phiFalse$ as a postcondition would make sense).
As a consequence, programmers may not be able to be imprecise about termination of a statement.
Note that \svlidf does not contain non-terminating constructs, so we did not deal with this problem in chapter \ref{ch:case-study--implicit}.
It is not clear how this case should be approached since the current definition of $\gamma(\qm)$ is clearly justified (for terminating programs), as otherwise $\gphiImplies{\withqmGen{\phiEq{x}{3}}}{\phiEq{x}{4}}$ holds, regardless of whether the lifted implication is optimal or not.
Maybe the introduction of an additional wildcard $\qm_{\bot}$ with $\gamma(\qm_{\bot}) = \setFormula$ proves useful in order to be imprecise about termination.

\subsection{Leveraging Implicit Dynamic Frames}%% IDF
In the case study, we have not made full use of the capabilities of implicit dynamic frames, yet.
Tracking exclusive access to memory locations also allows race-free reasoning about concurrent programs (Summers and Drossopoulou \cite{summers2013formal} give a corresponding Hoare logic).
It would be interesting to see gradual verification applied to such a setting, as it reflects more closely the reality of modern programming languages.
Further potential extensions include the introduction of shared access or the addition of non-separating conjunction to the formula syntax.
