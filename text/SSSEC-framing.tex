%% intro
The integral advantage of IDF is the ability to use heap-dependent predicates in formulas.
Accessibility-predicates are explicitly tracked as part of formulas and represent exclusive access to a certain field.
As illustrated in section \ref{ssec:implicit-dynamic-frames} sound reasoning is only possible if a formula contains access $\ttt{acc}$ for all the fields it mentions.
This property is called self-framing and will be formalized in this section.
%An IDF assertion is self-framing if:
%For any state in which the assertion is true,
%it remains true if we replace the heap with any that agrees on the locations to which it requires permissions

%% footprint
To decide whether a formula contains sufficient access to be self-framing, we need to extract from it the set of fields that it has access to.
This set is called footprint and has type $\setSFootprint \defeq \PP^{\setExpr \times \setFieldName}$.
A function $\staticFP{\cdot} : \setFormula \rightarrow \setSFootprint$ obtaining a formulas footprint is defined in figure \ref{fig:sfp}.
\begin{figure}[h]
    \boxed{\staticFP {\phi} = A_s}
    \input{data/svl-sem-stat-fp}
    \caption{\svlidf: Static Footprint}
    \label{fig:sfp}
\end{figure}

\begin{example}{Footprints of Formulas}
\begin{flalign*}
  	 & \staticFP{\phiCons{\phiEq{x}{3}}{\phiNeq{p.age}{24}}} = \emptyset                                                                                                                       \\
  	 & \staticFP{\phiCons{\phiCons{\phiEq{x}{3}}{\phiAcc{p}{age}}}{\phiNeq{p.age}{24}}} = \{ \langle \ttt{p}, \ttt{age} \rangle \}                                                             \\
  	 & \staticFP{\phiCons{\phiCons{\phiAcc{p}{age}}{\phiAcc{p}{name}}}{\phiAcc{x}{f}}} = \{ \langle \ttt{p}, \ttt{age} \rangle, \langle \ttt{p}, \ttt{name} \rangle, \langle \ttt{x}, \ttt{f} \rangle \}
\end{flalign*}
\end{example}
% examples? more explanation?

With the notion of footprints, we can determine whether an expression is “framed” by a given footprint, i.e. whether the footprint contains all the fields the expression contains.
We formalize this check using a predicate $\sfrme \subseteq \setSFootprint \times \setExpr$, defined in figure \ref{fig:svl-frme}.
\begin{figure}
    \boxed{A_s \sfrme e}
    \input{data/svl-sem-stat-frme}
    \caption{\svlidf: Framing Expressions}
    \label{fig:svl-frme}
\end{figure}

At last, we can define a predicate $\sfrmphi \subseteq \setSFootprint \times \setFormula$ that checks whether given footprint is sufficient to frame an entire formula, i.e. all the expressions the formula contains.
Figure \ref{fig:svl-frmphi} formalizes the predicate.
\begin{figure}
    \boxed{A_s \sfrmphi \phi}
    \input{data/svl-sem-stat-frmphi}
    \caption{\svlidf: Framing Formulas}
    \label{fig:svl-frmphi}
\end{figure}
Note how \tset{SfrmSepOp} augments the footprint the right sub-formula is checked against using the footprint of the left sub-formula.
This way, access predicates within a formula are able to frame expressions in the same formula, however only to the right.

\begin{example}{Framing Formulas}
    \begin{flalign*}
    	\emptyset                                & \sfrmphi \phiNeq{p.age}{24}                            && \text{does not hold} \\
    	\{ \langle \ttt{p}, \ttt{age} \rangle \} & \sfrmphi \phiNeq{p.age}{24}                            && \text{holds}         \\
    	\emptyset                                & \sfrmphi \phiCons{\phiAcc{p}{age}}{\phiNeq{p.age}{24}} && \text{holds}         \\
    	\emptyset                                & \sfrmphi \phiCons{\phiNeq{p.age}{24}}{\phiAcc{p}{age}} && \text{does not hold}
    \end{flalign*}
\end{example}

We omit the emptyset... 

\begin{definition}[Self-Framing Formula]
    A formula $\phi$ is \textbf{self-framing} iff
    \begin{displaymath}
    \sfrmphi \phi
    \end{displaymath}
    Let $\setFormulaB \subseteq \setFormulaA$ be the set of \textbf{self-framing and satisfiable} formulas.
\end{definition}


\svl will thus only consider method contracts using self-framing and satisfiable formulas well-formed (see section \ref{sec:well-formedness}).


%IS conservative approximation of formulas that are dynamically framed (not possible precisely anyway!)